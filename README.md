# Security Alert Monitor

A robust Python tool for monitoring, analyzing, and responding to security alerts generated by Security Onion or other security monitoring platforms.

## üõ°Ô∏è Overview

Security Alert Monitor automatically processes security alert CSV files, identifies potential attack patterns using customizable detection algorithms, and sends email notifications when suspicious activity is detected. The script can analyze individual files or continuously monitor a directory for new alert data.

![Security Alert Monitoring](https://img.shields.io/badge/Security-Alert%20Monitoring-blue)
![Python 3.6+](https://img.shields.io/badge/Python-3.6+-green)
![License MIT](https://img.shields.io/badge/License-MIT-orange)

## ‚ú® Features

- **Flexible CSV Processing**: Works with various CSV formats and field naming conventions
- **Advanced Attack Detection**:
  - Volume-based detection (alert threshold within a time window)
  - Pattern-based detection (signature matching against known attack types)
  - Time correlation for identifying related alerts
- **Intelligent Alert Correlation**:
  - Groups alerts by source IP
  - Analyzes alert frequency and patterns
  - Identifies attack types based on signature content
- **Attack Types Detection**:
  - Port scanning
  - Brute force attempts
  - Malware infections
  - SQL injection attempts
  - Cross-site scripting (XSS)
  - DDoS attacks
  - Data exfiltration
  - General suspicious activity
- **Email Notifications**:
  - Detailed summaries of detected attacks
  - Configurable alert thresholds
  - Secure email delivery via TLS

## üöÄ Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/yourusername/security-alert-monitor.git
   cd security-alert-monitor
   ```

2. Install dependencies:
   ```bash
   pip install pandas
   ```
https://drive.google.com/file/d/1DkX6EZEJ8C8jrtbZ99yqI-vy60xyKWFE/view?usp=drive_link - this video also walks through it
## üìã Usage

### Process a Single CSV File

```bash
python security_alert_monitor.py -f /path/to/alerts.csv --email your_email@gmail.com --password your_app_password
```

### Monitor a Directory for New Files

```bash
python security_alert_monitor.py -d /path/to/alert/directory --email your_email@gmail.com --password your_app_password
```

### Configuration Options

```
Security Alert Monitor

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  Path to CSV file to process
  -d DIRECTORY, --directory DIRECTORY
                        Path to directory to monitor
  --email EMAIL         Email address to send from
  --password PASSWORD   Email password or app password
  --threshold THRESHOLD
                        Number of alerts to trigger notification (default: 10)
  --window WINDOW       Time window in minutes for alert correlation (default: 60)
  --interval INTERVAL   Directory check interval in seconds (default: 60)
```

### Environmental Variables

For better security, you can set email credentials as environment variables:

```bash
export ALERT_EMAIL="your_email@gmail.com"
export ALERT_EMAIL_PASSWORD="your_app_password"
```

## üîß Customization

### Adjusting Attack Detection Thresholds

Edit the `_define_attack_patterns` method in the `SecurityAlertMonitor` class to adjust detection patterns:

```python
def _define_attack_patterns(self):
    """Define patterns that might indicate different types of attacks."""
    return {
        "port_scan": {
            "signature_regex": r"(?i)(scan|recon|probe)",
            "min_count": 5,  # Minimum alerts to trigger detection
            "severity": "high" 
        },
        # Add more patterns or modify existing ones
    }
```

### Modifying Alert Thresholds

When running the script, you can adjust the threshold for volume-based detection:

```bash
python security_alert_monitor.py -f alerts.csv --threshold 20 --window 30
```

This would trigger an alert when 20 or more alerts occur within a 30-minute window.

## üìä Email Alert Example

```
SECURITY ALERT: 2 Potential Attacks Detected

Security Alert Monitor has detected potential cyber attacks:

ATTACK #1 - PORT SCAN (Severity: HIGH)
--------------------------------------------------
Source IP: 192.168.1.105
Alert Count: 15 in 60 minutes

Top Signatures:
- Port scan detected (10 occurrences)
- Potential reconnaissance activity (3 occurrences)
- Unusual port probe (2 occurrences)

Sample Alerts:
  1. Port scan detected 
     From: 192.168.1.105 To: 10.0.0.15
  2. Port scan detected
     From: 192.168.1.105 To: 10.0.0.16
  3. Potential reconnaissance activity
     From: 192.168.1.105 To: 10.0.0.1

ATTACK #2 - BRUTE_FORCE (Severity: HIGH)
--------------------------------------------------
Source IP: 192.168.1.210
Alert Count: 12 in 60 minutes

Matching Signatures:
- Multiple failed login attempts
- Brute force attack detected
- Authentication failure

Sample Alerts:
  1. Multiple failed login attempts
     From: 192.168.1.210 To: 10.0.0.25
  2. Brute force attack detected
     From: 192.168.1.210 To: 10.0.0.25
  3. Authentication failure
     From: 192.168.1.210 To: 10.0.0.25

--------------------------------------------------
This is an automated alert from Security Alert Monitor.
Generated at: 2025-05-21 14:28:32
```

## üîÑ Integration with Security Onion

This script is designed to work with Security Onion alerts stored in CSV format. Configure Security Onion to output alerts to a directory, then set the script to monitor that directory:

```bash
python security_alert_monitor.py -d /var/log/securityonion/alerts --interval 300
```

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## üìú License

This project is licensed under the MIT License - see the LICENSE file for details.

## ‚ö†Ô∏è Disclaimer

This tool is provided for legitimate security monitoring purposes only. Always ensure you have proper authorization before monitoring any network or system.

## üì¨ Contact

If you have any questions or suggestions, please open an issue in the GitHub repository or contact me at [akshayagarwal307@gmail.com](mailto:akshayagarwal307@gmail.com).
